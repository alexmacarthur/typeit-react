/**
  *
  * TypeIt - React
  * Author: Alex MacArthur <alex@macarthur.me> (https://macarthur.me)
  * Version: v0.1.0-rc4
  * License: GPL-2.0
  * URL: https://typeitjs.com
  *
  */
import{createElement as n,useRef as t,useEffect as e,useState as r,useMemo as i}from"react";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var o=function(){return(o=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)};var u={strings:[],speed:100,cursor:!0,cursorChar:"|",cursorSpeed:1e3,deleteSpeed:null,lifeLike:!0,breakLines:!0,startDelay:250,startDelete:!1,nextStringDelay:750,loop:!1,loopDelay:750,html:!0,waitUntilVisible:!1,beforeString:function(){},afterString:function(){},beforeStep:function(){},afterStep:function(){},afterComplete:function(){}},c=function(n){return n.map((function(n){return void 0===n[1]&&n.push(null),void 0===n[2]&&n.push({}),n}))},a=function(n,t){return Object.assign({},n,t)},f=function(n){return Array.isArray(n)},s=function(n,t){return n[2]=a(n[2],t)||t,n},l=function(n,t){return f(n[0])?n.map((function(n){return s(n,t)})):s(n,t)},d=function(n,t,e,r){r=r||!1,e=e||{};var i=!f(n),o=n.length;return(n=i?new Array(n).fill(0):n).map((function(n,u){if(i)return t;var c=[t,n,e];return r&&(0===u&&(c=l(c,{isFirst:!0})),u+1===o&&(c=l(c,{isLast:!0}))),c}))};function h(n){this.insert=function(n,e){t.splice(n,0,e)},this.add=function(n,e,r){return n=f(n)?n:[n,null],r=r||!1,e=e||1,f(n[0])||(n=d(e,n)),t=r?n.concat(t):t.concat(n),this},this.delete=function(n){return t.splice(n,1),this},this.reset=function(){return t=c(t).map((function(n){return n[2].executed=!1,n})),this},this.getItems=function(){return c(t).filter((function(n){return!n.executed}))};var t=[];n&&this.add(n)}var p=function(n){return Array.from(n)},v=function(n){var t=[];return t.concat.apply(t,n)},m=function(n){var t=document.implementation.createHTMLDocument("");return t.body.innerHTML=n,t.body},y=function(n){return 3===n.nodeType||"BR"===n.tagName},g=function n(t,e,r){e=e||null,r=void 0!==r&&r;var i=p(t.childNodes).map((function(t){return y(t)?t:n(t)}));return i=v(i),e&&(i=i.filter((function(n){return!n.parentNode.isEqualNode(e)}))),r?i.reverse():i},b=function(n){return"BODY"===n.tagName},S=function(n,t){t=t||null;var e=n instanceof HTMLElement;return{node:t,isTopLevelText:(!t||b(t.parentNode))&&!e,isHTMLElement:e,content:n}};function T(n){var t,e=m(n);return t=g(e).map((function(n){return n.nodeValue?p(n.nodeValue).map((function(t){return S(t,n)})):S(n)})),v(t)}function x(n,t){return(t=void 0===t||t)?T(n):p(n).map((function(n){return S(n)}))}var w=function(n){return document.createElement(n)},N=function(n,t){var e=w("style");e.id=t||"",e.appendChild(document.createTextNode(n)),document.head.appendChild(e)},L=function(n){return f(n)||(n=[n/2,n/2]),{before:n[0],after:n[1],total:n[0]+n[1]}},M=function(n,t){return Math.abs(Math.random()*(n+t-(n-t))+(n-t))},O=function(n){return["textarea","input"].indexOf(n.tagName.toLowerCase())>-1},D=function(n,t){var e=t.querySelectorAll("*");return[t].concat(p(e).reverse()).find((function(t){return t.cloneNode().outerHTML===n.outerHTML}))},E=function(n,t,e,r){e=e||null;var i=t.isHTMLElement,o=i?t.content:document.createTextNode(t.content);if(O(n))n.value="".concat(n.value).concat(t.content);else{if(!t.isTopLevelText&&!i){var u=t.node.parentNode,c=D(u.cloneNode(),n);if(function(n,t){if(!n)return!1;var e=n.nextSibling;return!e||e.isEqualNode(t)}(c,e))n=c;else if((o=u.cloneNode()).innerText=t.content,!b(u.parentNode)){for(var a=u.parentNode,f=a.cloneNode(),s=D(f,n);!s&&!b(a);)f.innerHTML=o.outerHTML,o=f,f=a.parentNode.cloneNode(),a=a.parentNode,s=D(f,n);n=s||n}}var l=g(n,e,!0)[r-1],d=l?l.parentNode:n;d.insertBefore(o,d.contains(e)?e:null)}},C=function(n){return n&&n.parentNode.removeChild(n)},P=function(n){return!n.firstChild&&!y(n)},H=function(n){return n.some((function(n){return P(n)}))},A=function(n,t,e){var r,i="string"==typeof n,o=!1,u=-1*n;return i&&(u=(r="END"===n.toUpperCase())?-1:1,o=r?t+u>0:t+u<e.length),{isString:i,numberOfSteps:u,canKeepMoving:o}},I=function(n){return window.getComputedStyle(n,null)};function k(n,t,e){return e?t?t(n):n:(n&&n.then||(n=Promise.resolve(n)),t?n.then(t):n)}function z(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return Promise.resolve(n.apply(this,t))}catch(n){return Promise.reject(n)}}}function B(){}function j(n,t){if(!t)return n&&n.then?n.then(B):Promise.resolve()}function q(n,t){var e=n();return e&&e.then?e.then(t):t(e)}function R(n,t,e){if(!n.s){if(e instanceof V){if(!e.s)return void(e.o=R.bind(null,n,t));1&t&&(t=e.s),e=e.v}if(e&&e.then)return void e.then(R.bind(null,n,t),R.bind(null,n,2));n.s=t,n.v=e;var r=n.o;r&&r(n)}}var V=function(){function n(){}return n.prototype.then=function(t,e){var r=new n,i=this.s;if(i){var o=1&i?t:e;if(o){try{R(r,1,o(this.v))}catch(n){R(r,2,n)}return r}return this}return this.o=function(n){try{var i=n.v;1&n.s?R(r,1,t?t(i):i):e?R(r,1,e(i)):R(r,2,i)}catch(n){R(r,2,n)}},r},n}();function U(n,t){return n&&n.then?n.then(t):t(n)}function F(n,t){var e=this,r=this;t=t||{};var i=function(n,t){return an.add(n,t),e},o=function(n){n=n||{};var t=a({},en),e=a(t,n);return[[Q,e,{force:!0}],[Q,t,{force:!0}]]},c=function(){return X?p(W.value):g(W,fn,!0)},s=function(n,t){t=t||1;var e=en.nextStringDelay;an.insert(n,[D,e.before]),an.insert(n+t+1,[D,e.after])},l=function(n){fn&&(fn.classList.toggle("disabled",n),fn.classList.toggle("with-delay",!n))},v=z((function(n,t){return $.push(setTimeout(n,t)),k()})),y=z((function(n){return q((function(){if(_)return j(move(-1*_))}),(function(){an.reset().delete(0).add([D,n.before],!0),c().forEach((function(n){an.add([G,null,{isPhantom:!0}],1,!0)}))}))})),b=z((function(){tn.started=!0;var n=an.getItems();return U(function(n,t){try{var e=n()}catch(n){return t(n)}return e&&e.then?e.then(void 0,t):e}((function(){return U(function(n,t,e){var r,i,o=-1;return function e(u){try{for(;++o<n.length;)if((u=t(o))&&u.then){if(!((c=u)instanceof V&&1&c.s))return void u.then(e,i||(i=R.bind(null,r=new V,2)));u=u.v}r?R(r,1,u):r=u}catch(n){R(r||(r=new V),2,n)}var c}(),r}(n,(function(t){if(tn.frozen||tn.destroyed)throw"";var e,i,o,u,c=n[t],a=c[2],f=[c,r];return a.freezeCursor&&l(!0),e=en.speed,i=en.deleteSpeed,o=en.lifeLike,u=(i=null!==i?i:e/3)/2,Z=o?[M(e,e/2),M(i,u)]:[e,i],q((function(){var n;if(null==a?void 0:a.isFirst)return j((n=en).beforeString.apply(n,f))}),(function(){var n;return k((n=en).beforeStep.apply(n,f),(function(){return k(c[0].call(r,c[1],a),(function(){return q((function(){if(!a||!a.isPhantom)return q((function(){var n,t;if(null===(n=c[2])||void 0===n?void 0:n.isLast)return j((t=en).afterString.apply(t,f))}),(function(){var n;return k((n=en).afterStep.apply(n,f),(function(){c[2].executed=!0}))}))}),(function(){l(!1)}))}))}))}))})),(function(n){return tn.completed=!0,k(en.afterComplete(r),(function(){if(en.loop){var n=en.loopDelay||en.nextStringDelay;v((function(){return k(y(n),(function(){b()}))}),n.after)}}))}))}),B),(function(n){return r}))})),D=function(n){return new Promise((function(t){v((function(){return t()}),n||en.nextStringDelay.total)}))},F=function n(t){var e=c(),r=A(t,_,e);return _+=r.numberOfSteps,new Promise((function(t){v(z((function(){return function(n,t,e,r){if(e){var i=r,o=t[(i=i>t.length?t.length:i)-1];(n=o?o.parentNode:n).insertBefore(e,o||null)}}(W,c(),fn,_),q((function(){if(r.isString&&r.canKeepMoving)return j(n(r.numberOfSteps>0?"START":"END"))}),(function(){return t()}))})),Z[0])}))},K=function(n){return new Promise((function(t){v((function(){return E(W,n,fn,_),t()}),Z[0])}))},Q=z((function(n){en=a(en,n)})),Y=z((function(){X?W.value="":c().forEach((function(n){C(n)}))})),G=function n(t){return t=!0===t,new Promise((function(e){v(z((function(){var r=!1,i=c();return i.length&&(X?W.value=W.value.slice(0,-1):C(i[_])),function(n){for(var t=p(n.querySelectorAll("*")),e=H(t);t.length&&e;){var r=!1;t.forEach((function(n){P(n)&&(C(n),r=!0)})),r&&(t=p(n.querySelectorAll("*"))),e=H(t)}}(W),q((function(){if(t&&i.length-1>0)return k(n(!0),(function(){return r=!0,e()}))}),(function(n){return r?n:e()}))})),Z[1])}))};this.break=function(){return i([K,S(w("BR"))])},this.delete=function(n,t){var e=o(t);return an.add(e[0]),an.add([G,!n,nn],n||1),an.add(e[1]),this},this.destroy=function(n){n=void 0===n||n,$.forEach((function(n){clearTimeout(n)})),$=[],n&&C(fn),tn.destroyed=!0},this.empty=function(){return i(Y)},this.exec=function(n,t){var e=o(t);return i([e[0],[n,null],e[1]])},this.is=function(n){return tn[n]},this.move=function(n,t){var e=A(n,_,c()),r=o(t);return an.add(r[0]),an.add([F,e.isString?n:Math.sign(n),nn],Math.abs(n)),an.add(r[1]),this},this.freeze=function(){tn.frozen=!0},this.unfreeze=function(){tn.frozen=!1,!tn.frozen&&b()},this.options=function(n){return i([Q,n])},this.pause=function(n){return i([D,n||null])},this.type=function(n,t){var e=o(t),r=x(n,en.html),u=[e[0]].concat(d(r,K,nn,!0),[e[1]]);return i(u)},this.getQueue=function(){return an},this.getOptions=function(){return en},this.getElement=function(){return W},this.reset=function(){for(var n in!this.is("destroyed")&&this.destroy(),an.reset(),tn)tn[n]=!1;return this},this.go=function(){return tn.started?this:(function(){if(fn){var n="[data-typeit-id='".concat(cn,"'] .ti-cursor");N("@keyframes blink-".concat(cn," { 0% {opacity: 0} 49% {opacity: 0} 50% {opacity: 1} } ").concat(n," { animation: blink-").concat(cn," ").concat(en.cursorSpeed/1e3,"s infinite; } ").concat(n,".with-delay { animation-delay: 500ms; } ").concat(n,".disabled { animation: none; }"),cn),W.appendChild(fn);var t,e,r=fn.getBoundingClientRect().width-(t=fn,(e=w("canvas").getContext("2d")).font=I(t).getPropertyValue("font-size"),e.measureText(t.innerText).width);fn.style.margin="0 -".concat(r,"px")}}(),en.waitUntilVisible?(function(n,t){new IntersectionObserver((function(e,r){e.forEach((function(e){e.isIntersecting&&(t(),r.unobserve(n))}))}),{threshold:1}).observe(n)}(W,b.bind(this)),this):(b(),this))};var J,W="string"==typeof(J=n)?document.querySelector(J):J,X=O(W),Z=[],$=[],_=0,nn={freezeCursor:!0},tn={started:!1,completed:!1,frozen:!1,destroyed:!1},en=a(u,t);en=a(en,{html:!X&&en.html,nextStringDelay:L(en.nextStringDelay),loopDelay:L(en.loopDelay)});var rn,on,un,cn=Math.random().toString().substring(2,9),an=new h([D,en.startDelay]);W.setAttribute("data-typeit-id",cn),N("[data-typeit-id]:before {content: '.'; display: inline-block; width: 0; visibility: hidden;}"),en.strings=(un=en.strings,rn=f(un)?un:[un],(on=function(n){return n.innerHTML.replace(/<\!--.*?-->/g,"").trim()}(W))?(W.innerHTML="",en.startDelete?(T(on).forEach((function(n){E(W,n,fn,_)})),an.add([G,!0]),s(1),rn):[on.trim()].concat(rn)):rn);var fn=function(){if(X||!en.cursor)return null;var n=w("span");return n.innerHTML=m(en.cursorChar).innerHTML,n.className="ti-cursor",n.style.cssText="display:inline;".concat(function(n){var t=["font","lineHeight","color"],e=w("SPAN"),r=I(n);for(var i in r)t.indexOf(i)>-1&&r[i]&&(e.style[i]=r[i]);return e.style.cssText}(W)),n}();en.strings.length&&function(){var n=en.strings;n.forEach((function(t,e){var r=x(t,en.html);an.add(d(r,K,nn,!0));var i=an.getItems().length;if(e+1!==n.length){if(en.breakLines){var o=S(w("BR"));return an.add([K,o,nn]),void s(i)}an.add(d(r,G,nn)),s(i,t.length)}}))}()}var K=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"],Q=t,Y=e,G=r,J=i,W=function(t){var e=G(!0),r=e[0],i=e[1],u=Q(null),c=t.options,a=t.element,f=t.children,s=t.getBeforeInit,l=t.getAfterInit,d=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]])}return e}(t,["options","element","children","getBeforeInit","getAfterInit"]),h=a,p=J((function(){return n=h,K.indexOf(n.toLowerCase())>-1;var n}),[h]);return Y((function(){f&&(c.strings=u.current.innerHTML),i(!1)}),[]),Y((function(){if(!r){var n=new F(u.current,o({},c));return(n=s(n)).go(),n=l(n),function(){n.destroy()}}}),[r]),n("div",{style:{opacity:r?0:1}},p?n(h,o({ref:u},d)):n(h,o({ref:u},d),r&&f))};W.defaultProps={element:"span",options:{},getBeforeInit:function(n){return n},getAfterInit:function(n){return n}};export default W;
